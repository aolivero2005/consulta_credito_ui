
<div class="container">
  <h1>{{ title() }}</h1>

  <div class="search-container">
    <div class="search-input">
      <input
        type="text"
        [(ngModel)]="searchValue"
        placeholder="Ingrese número de NFS-e o número de crédito"
      />
      <button (click)="searchByNfse()">Buscar por NFS-e</button>
      <button (click)="searchByCredit()">Buscar por Número de Crédito</button>
    </div>

    @if (error) {
      <div class="error">{{ error }}</div>
    }
  </div>


  @if (loading) {
    <div class="loading">Cargando resultados...</div>
  } @else if (results.length > 0) {
    <div class="results-count">Mostrando {{ results.length }} resultados</div>
    <table class="results-table">
      <thead>
        <tr>
          <th>Número de Crédito</th>
          <th>Número NFS-e</th>
          <th>Fecha de Constitución</th>
          <th>Valor ISSQN</th>
          <th>Tipo de Crédito</th>
          <th>Simples Nacional</th>
          <th>Alícuota</th>
          <th>Valor Facturado</th>
          <th>Valor Deducción</th>
          <th>Base de Cálculo</th>
        </tr>
      </thead>
      <tbody>
        @for (item of results; track $index) {
          <tr>
            <td>{{ item.numeroCredito || 'N/A' }}</td>
            <td>{{ item.numeroNfse || 'N/A' }}</td>
            <td>{{ item.dataConstituicao || 'N/A' }}</td>
            <td>{{ item.valorIssqn || 'N/A' }}</td>
            <td>{{ item.tipoCredito || 'N/A' }}</td>
            <td>{{ item.simplesNacional !== undefined ? (item.simplesNacional ? 'Sí' : 'No') : 'N/A' }}</td>
            <td>{{ item.aliquota !== undefined ? item.aliquota + '%' : 'N/A' }}</td>
            <td>{{ item.valorFaturado || 'N/A' }}</td>
            <td>{{ item.valorDeducao || 'N/A' }}</td>
            <td>{{ item.baseCalculo || 'N/A' }}</td>
          </tr>
        }
      </tbody>
    </table>
  } @else if (!loading && searchValue) {
    <div>No se encontraron resultados para la búsqueda.</div>
  }
</div>

<router-outlet />
